name:           create_migrated_hdd_online.yaml
description:    |
  This is for creating hdd for migration regression test.
  #REGRESSION_SERVICE: '1' means support service check test. '0' means doesn't
  #support service check test, normally set '0' for package media test.
vars:
  DESKTOP: gnome
  BOOT_HDD_IMAGE: 1
  ORIGIN_SYSTEM_VERSION: '%HDDVERSION%'
  UPGRADE_TARGET_VERSION: '%VERSION%'
schedule:
  - migration/version_switch_origin_system
  - '{{online_migration_test}}'
  - '{{install_service}}'
  - migration/version_switch_upgrade_target
  - migration/online_migration/pre_migration
  - '{{migration_method}}'
  - migration/online_migration/post_migration
  - console/check_os_release
  - console/check_system_info
  - console/check_network
  - console/system_state
  - console/prepare_test_data
  - console/consoletest_setup
  - shutdown/cleanup_before_shutdown
  - shutdown/shutdown
conditional_schedule:
  migration_method:
    MIGRATION_METHOD:
      yast:
        - migration/online_migration/yast2_migration
      zypper:
        - migration/online_migration/zypper_migration
  online_migration_test:
    ONLINE_MIGRATION:
      1:
        - installation/isosize
        - installation/bootloader
        - migration/online_migration/online_migration_setup
        - migration/online_migration/register_system
        - migration/online_migration/zypper_patch
  install_service:
    REGRESSION_SERVICE:
      1:
        - installation/install_service
